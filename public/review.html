<!DOCTYPE html>
<html>
<head>
    <title>Course Reviews</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="review-container">
        <h1>Course List</h1>
        <div id="class-list">
        </div>
        <button id="review-back-button">Back</button>
    </div>

    <script type="module">
        import { collection, getDocs, getFirestore, initializeApp, getApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";
        import "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";

        // Your Firebase configuration (ensure this matches your firebase-init.js)
        const firebaseConfig = {
            apiKey: "AIzaSyDVhIJ_abp8jQJi8QAtsnvg-WKkPbNlPqI",
            authDomain: "project-polaris-statefarm.firebaseapp.com",
            projectId: "project-polaris-statefarm",
            storageBucket: "project-polaris-statefarm.firebasestorage.app",
            messagingSenderId: "918316280295",
            appId: "1:918316280295:web:1d5cd9584ad5f1b6f63542",
            measurementId: "G-NFCNZMLTV1"
        };

        // Initialize Firebase if not already initialized
        let firebaseApp;
        try {
            firebaseApp = initializeApp(firebaseConfig);
        } catch (e) {
            firebaseApp = getApp(); // If already initialized, get the existing app
        }
        const db = getFirestore(firebaseApp);

        document.addEventListener('DOMContentLoaded', () => {
            const courseListDiv = document.getElementById('class-list');

            const fetchCourses = async () => {
                try {
                    const coursesSnapshot = await getDocs(collection(db, 'courses'));

                    coursesSnapshot.forEach(doc => {
                        const courseData = doc.data();
                        const courseDiv = document.createElement('div');
                        courseDiv.classList.add('course-item');

                        const courseLink = document.createElement('a');
                        courseLink.classList.add('course-link');
                        courseLink.textContent = courseData.courseName;
                        courseLink.href = `course-detail.html?courseId=${doc.id}`;

                        courseDiv.appendChild(courseLink);
                        courseListDiv.appendChild(courseDiv);
                    });
                } catch (error) {
                    console.error('Error fetching courses:', error);
                    courseListDiv.textContent = 'Error loading courses.';
                }
            };

            fetchCourses();

            const backButton = document.getElementById('review-back-button');
            if (backButton) {
                backButton.addEventListener('click', function() {
                    window.location.href = 'index.html';
                });
            } else {
                console.log("Back button not found.");
            }
        });
    </script>
</body>
</html>
